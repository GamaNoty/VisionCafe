{% extends 'layout/base.html' %}
{% load static %}
{% load qr_code %}

{% block title %}Stůl {{ table.number }} | Objednávka{% endblock %}

{% block extra_css %}
    <link rel="stylesheet" href="{% static 'css/table.css' %}">
{% endblock %}

{% block content %}
<div class="card text-center">
    <h1>Stůl {{ table.number }}</h1>
    
    <div class="qr-section">
        {% qr_from_text full_url size="M" border=2 %}
        <p class="small-gray">Naskenujte pro rychlou objednávku z tohoto stolu</p>
    </div>

    <div class="order-form">
        <form method="post">
            {% csrf_token %}
            <label for="product_type">Na co máte chuť?</label>
            <select name="product_type" id="product_type" required>
                <option value="" disabled selected>Vyberte si nápoj...</option>
                {% for pt in product_types %}
                    <option value="{{ pt.id }}">{{ pt }}</option>
                {% endfor %}
            </select>
            <button type="submit" class="mt-1">Odeslat objednávku</button>
        </form>
    </div>
</div>

<div class="card mt-2">
    <h3>Vaše dnešní objednávky</h3>
    <table class="history-table">
        <tbody>
            {% for order in orders %}
            <tr>
                <td>
                    <strong>{{ order.product_type }}</strong><br>
                    <small class="small-gray">{{ order.created_at|date:"H:i" }}</small>
                </td>
                <td class="text-right">
                    {% include 'orders/includes/status_badge.html' %}
                </td>
            </tr>
            {% empty %}
            <tr>
                <td colspan="2" class="text-center small-gray" style="padding: 2rem;">
                    Zatím jste si nic neobjednali.
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% endblock %}